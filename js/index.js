// var YOUR_API_KEY = "AIzaSyCRl-M5wCloEJ40LerD6hAK19D0iRAgbVs";

// fetch(
//   `https://youtube.googleapis.com/youtube/v3/commentThreads?part=id%2C%20snippet&searchTerms=vipul%20kumar&videoId=DuudSp4sHmg&key=${YOUR_API_KEY}`
// )
//   .then((response) => response.json())
//   .then((data) => console.log(data.items[0].snippet.topLevelComment.snippet));

const animationData = `{"v":"5.9.5","fr":24,"ip":0,"op":77,"w":1778,"h":1000,"nm":"Short-logo6.0","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":3,"nm":"Null 2","sr":1,"ks":{"o":{"a":0,"k":0,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.191],"y":[1]},"o":{"x":[1],"y":[0]},"t":14,"s":[45]},{"t":32,"s":[0]}],"ix":10},"p":{"a":0,"k":[889,500,0],"ix":2,"l":2},"a":{"a":0,"k":[0,0,0],"ix":1,"l":2},"s":{"a":0,"k":[64.553,64.553,100],"ix":6,"l":2}},"ao":0,"ip":0,"op":480,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Layer 3 Outlines","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[0,0,0],"ix":2,"l":2},"a":{"a":0,"k":[568.562,568.563,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"ef":[{"ty":25,"nm":"Drop Shadow","np":8,"mn":"ADBE Drop Shadow","ix":1,"en":1,"ef":[{"ty":2,"nm":"Shadow Color","mn":"ADBE Drop Shadow-0001","ix":1,"v":{"a":0,"k":[0,0,0,1],"ix":1}},{"ty":0,"nm":"Opacity","mn":"ADBE Drop Shadow-0002","ix":2,"v":{"a":0,"k":89.25,"ix":2}},{"ty":0,"nm":"Direction","mn":"ADBE Drop Shadow-0003","ix":3,"v":{"a":0,"k":135,"ix":3}},{"ty":0,"nm":"Distance","mn":"ADBE Drop Shadow-0004","ix":4,"v":{"a":0,"k":0,"ix":4}},{"ty":0,"nm":"Softness","mn":"ADBE Drop Shadow-0005","ix":5,"v":{"a":0,"k":200,"ix":5}},{"ty":7,"nm":"Shadow Only","mn":"ADBE Drop Shadow-0006","ix":6,"v":{"a":0,"k":0,"ix":6}}]}],"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,-217.359],[217.359,0],[0,217.359],[-217.358,0]],"o":[[0,217.359],[-217.358,0],[0,-217.359],[217.359,0]],"v":[[393.562,0],[0,393.563],[-393.562,0],[0,-393.563]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.29],"y":[1]},"o":{"x":[1],"y":[0]},"t":9,"s":[0]},{"t":32,"s":[100]}],"ix":1},"e":{"a":0,"k":0,"ix":2},"o":{"a":0,"k":-344,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":70,"ix":5},"lc":1,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[568.562,568.563],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":480,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Layer 5 Outlines","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[9.152,132.196,0],"ix":2,"l":2},"a":{"a":0,"k":[137.87,139.044,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"ef":[{"ty":25,"nm":"Drop Shadow","np":8,"mn":"ADBE Drop Shadow","ix":1,"en":1,"ef":[{"ty":2,"nm":"Shadow Color","mn":"ADBE Drop Shadow-0001","ix":1,"v":{"a":0,"k":[0,0,0,1],"ix":1}},{"ty":0,"nm":"Opacity","mn":"ADBE Drop Shadow-0002","ix":2,"v":{"a":0,"k":89.25,"ix":2}},{"ty":0,"nm":"Direction","mn":"ADBE Drop Shadow-0003","ix":3,"v":{"a":0,"k":135,"ix":3}},{"ty":0,"nm":"Distance","mn":"ADBE Drop Shadow-0004","ix":4,"v":{"a":0,"k":0,"ix":4}},{"ty":0,"nm":"Softness","mn":"ADBE Drop Shadow-0005","ix":5,"v":{"a":0,"k":200,"ix":5}},{"ty":7,"nm":"Shadow Only","mn":"ADBE Drop Shadow-0006","ix":6,"v":{"a":0,"k":0,"ix":6}}]}],"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0]],"o":[[0,0],[0,0]],"v":[[341.762,-306.151],[-186.228,221.773]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":75,"ix":5},"lc":1,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[137.869,139.044],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.191],"y":[1]},"o":{"x":[1],"y":[0]},"t":0,"s":[50]},{"t":16,"s":[100]}],"ix":1},"e":{"a":0,"k":50,"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":480,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"Layer 4 Outlines 2","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[21.406,-47.628,0],"ix":2,"l":2},"a":{"a":0,"k":[547.602,470.349,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0]],"o":[[0,0],[0,0]],"v":[[-392.909,234.076],[154.285,-304.364]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.191],"y":[1]},"o":{"x":[1],"y":[0]},"t":0,"s":[100]},{"t":16,"s":[0]}],"ix":1},"e":{"a":0,"k":100,"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":75,"ix":5},"lc":1,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[547.602,470.349],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":480,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":5,"ty":4,"nm":"Layer 4 Outlines","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[21.406,-47.628,0],"ix":2,"l":2},"a":{"a":0,"k":[547.602,470.349,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0]],"v":[[294.159,282.849],[181.855,282.849],[181.855,181.628],[-355.815,198.197]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"tm","s":{"a":0,"k":100,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0.853],"y":[0.179]},"t":16,"s":[100]},{"t":39,"s":[0]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":75,"ix":5},"lc":1,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[547.602,470.349],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":480,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":6,"ty":1,"nm":"Black Solid 1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[889,500,0],"ix":2,"l":2},"a":{"a":0,"k":[889,500,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"hasMask":true,"masksProperties":[{"inv":false,"mode":"a","pt":{"a":0,"k":{"i":[[148.012,0],[0,-148.012],[-148.012,0],[0,148.012]],"o":[[-148.012,0],[0,148.012],[148.012,0],[0,-148.012]],"v":[[890,233],[622,501],[890,769],[1158,501]],"c":true},"ix":1},"o":{"a":0,"k":100,"ix":3},"x":{"a":0,"k":45,"ix":4},"nm":"Mask 1"}],"sw":1778,"sh":1000,"sc":"#000000","ip":0,"op":480,"st":0,"bm":0}],"markers":[]}`;
document.addEventListener("mousemove", function (e) {
  gsap.to(".cursor", {
    x: e.clientX,
    y: e.clientY,
    stagger: 0.05,
  });
});

const introContainer = document.querySelector("#intro");
const logo_animation = document.querySelector("#logo_animation");

const animation__container = document.querySelector("#logo_animation");

const anim = lottie.loadAnimation({
  container: animation__container,
  renderer: "svg",
  loop: false,
  autoplay: true,
  animationData: JSON.parse(animationData),
});

anim.addEventListener("complete", function () {
  introContainer.style.opacity = "0";
});

let about = gsap
  .timeline({ defaults: { ease: "none" }, repeat: -1 })
  .to(".left .animate__this1", {
    y: "0%",
    opacity: 1,
    duration: 0.9,
    ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
  })
  .to(".left .animate__this1", {
    y: "-140%",
    opacity: 0,
    delay: 1.7,
    duration: 0.9,
    ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
  })
  .to(
    ".left .animate__this2",
    {
      y: "0%",
      opacity: 1,
      duration: 0.9,
      ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
    },
    "-=0.9"
  )
  .to(
    ".left .animate__this2",
    {
      y: "-140%",
      opacity: 0,
      delay: 2.7,
      duration: 0.9,
      ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
    },
    "-=0.9"
  );

const myText = new SplitType("#my-text", { types: "lines,chars" });

let textAnim__section2__down = gsap.from("#my-text .char", 1.4, {
  y: "200%",
  skewX: -10,
  scaleY: 1.5,
  paused: true,
  delay: 1.3,
  stagger: 0.04,
  ease: CustomEase.create("custom", "M0,0,C0.5,0,0,1,1,1"),
});

const videoElement = document.querySelector("#video");

new fullpage("#fullpage", {
  //options here
  autoScrolling: true,
  scrollHorizontally: true,
  navigation: false,
  navigationPosition: "left",
  scrollingSpeed: 1300,
  easingcss3: "cubic-bezier(.70,0,.30,1)",
  anchors: ["first", "second", "third", "fourth", "fifth", "sixth"],
  credits: { enabled: false },
  afterLoad: function () {},

  onLeave: function (index, nextIndex, direction) {
    // console.log(index);

    // console.log(direction);
    if (nextIndex.anchor == "first") {
      if (direction == "down") {
      } else {
        about.seek(1.2);
      }
    }

    if (nextIndex.anchor == "second") {
      if (direction == "down") {
        // anim__section2__down.restart();
        textAnim__section2__down.restart();
      } else {
        // textAnim__section2__up.restart();
        // anim__section2__up.restart();
      }
    }

    if (nextIndex.anchor == "third") {
      videoElement.currentTime = 1.6;
      videoElement.play();
    }

    var flex = screen.width > 540 ? 17 : 5;
    if (direction == "down") {
      gsap
        .timeline()
        .from(`.${nextIndex.anchor} .rounded__div__down`, {
          duration: 0.1,
        })
        .fromTo(
          `.${nextIndex.anchor} .rounded__div__down`,
          {
            height: `${flex}vh`,
          },
          {
            height: "0vh",
            duration: 1.2,
            ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
          }
        );

      gsap
        .timeline()
        .from(`.${nextIndex.anchor} .anime`, {
          duration: 0.3,
        })
        .fromTo(
          `.${nextIndex.anchor} .anime`,
          {
            y: "30vh",
          },
          {
            y: "0vh",
            duration: 1.1,
            stagger: 0.14,
            ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
          }
        );
    } else {
      gsap
        .timeline()
        .from(`.${nextIndex.anchor} .rounded__div__up`, {
          duration: 0.1,
        })
        .fromTo(
          `.${nextIndex.anchor} .rounded__div__up`,
          {
            height: `${flex}vh`,
          },
          {
            height: "0vh",
            duration: 1.2,
            ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
          }
        );

      gsap
        .timeline()
        .from(`.${nextIndex.anchor} .anime`, {
          duration: 0.3,
        })
        .fromTo(
          `.${nextIndex.anchor} .anime`,
          {
            y: "-30vh",
          },
          {
            y: "0vh",
            duration: 1.1,
            stagger: -0.08,
            ease: CustomEase.create("custom", "M0,0 C0.52,0.01 0.16,1 1,1 "),
          }
        );
    }
  },
});

let direction = 1; // 1 = forward, -1 = backward scroll

const roll1 = roll(".rollingText", { duration: 15 });
// const roll2 = roll(".rollingText2", { duration: 15 });

gsap.fromTo(
  `.rollingText2`,
  {
    xPercent: 0,
  },
  {
    xPercent: -100,
    duration: 20,
    ease: CustomEase.create("custom", "M0,0,C0,0,1,1,1,1"),
    repeat: -1,
  }
);

gsap.fromTo(
  `.rollingText3`,
  {
    xPercent: 0,
  },
  {
    xPercent: -100,
    duration: 20,
    ease: CustomEase.create("custom", "M0,0,C0,0,1,1,1,1"),
    repeat: -1,
  }
);

gsap.set(`.rollingText3`, {
  left: `${document.querySelector(".rollingText3").offsetWidth}`,
});

// helper function that clones the targets, places them next to the original, then animates the xPercent in a loop to make it appear to roll across the screen in a seamless loop.
function roll(targets, vars, reverse) {
  vars = vars || {};
  vars.ease || (vars.ease = "none");
  const tl = gsap.timeline({
      repeat: -1,
      onReverseComplete() {
        this.totalTime(this.rawTime() + this.duration() * 10); // otherwise when the playhead gets back to the beginning, it'd stop. So push the playhead forward 10 iterations (it could be any number)
      },
    }),
    elements = gsap.utils.toArray(targets),
    clones = elements.map((el) => {
      let clone = el.cloneNode(true);
      el.parentNode.appendChild(clone);
      return clone;
    }),
    positionClones = () =>
      elements.forEach((el, i) =>
        gsap.set(clones[i], {
          position: "absolute",
          overwrite: false,
          top: el.offsetTop,
          left: "100%",
        })
      );
  positionClones();
  elements.forEach((el, i) =>
    tl.to([el, clones[i]], { xPercent: reverse ? 100 : -100, ...vars }, 0)
  );
  window.addEventListener("resize", () => {
    let time = tl.totalTime(); // record the current time
    tl.totalTime(0); // rewind and clear out the timeline
    positionClones(); // reposition
    tl.totalTime(time); // jump back to the proper time
  });
  return tl;
}

// // Variables
// const el = document.querySelector(".section__4 .title");
// const container = document.querySelector(".section__4 .container");

// // Variables ~ Widths
// let elWidth = el.offsetWidth;
// let windowWidth = window.innerWidth;

// // Variables ~ Mouse
// let mouseX = 0;
// let prevMouseX = 0;

// // Target: value we want to animate to
// let skewTarget = 0;
// let translateTarget = 0;

// // WithEasing: value we use to animate
// let skewWithEasing = 0;
// let translateWithEasing = 0;

// // EasingFactor: determines how quick the animation/interpolation goes
// let skewEasingFactor = 0.1;
// let translateEasingFactor = 0.05;

// // Events
// container.addEventListener("mousemove", handleMouseMove);
// container.addEventListener("resize", handleWindowResize);

// // Functions
// function handleMouseMove(e) {
//   mouseX = e.pageX;
// }

// function handleWindowResize(e) {
//   elWidth = el.offsetWidth;
//   windowWidth = window.innerWidth;
// }

// function lerp(start, end, factor) {
//   return (1 - factor) * start + factor * end;
// }

// function animateMe() {
//   // Get difference between current and previous mouse position
//   skewTarget = mouseX - prevMouseX;
//   prevMouseX = mouseX;

//   // Calc how much we need to translate our el
//   translateTarget = ((elWidth - windowWidth) / windowWidth) * mouseX * -1;

//   // Ease between start and target values (skew)
//   skewWithEasing = lerp(skewWithEasing, skewTarget, skewEasingFactor);

//   // Limit our skew to a range of 75 degrees so it doesn't "over-skew"
//   skewWithEasing = Math.min(Math.max(parseInt(skewWithEasing), -75), 75);

//   // Ease between start and target values (translate)
//   translateWithEasing = lerp(
//     translateWithEasing,
//     translateTarget,
//     translateEasingFactor
//   );

//   el.style.transform = `translateX(${translateWithEasing}px)`;

//   //   el.style.transform = `
//   //   translateX(${translateWithEasing}px)
//   //   skewX(${skewWithEasing}deg)
//   // `;

//   // RAF
//   window.requestAnimationFrame(animateMe);
// }

// window.requestAnimationFrame(animateMe);
